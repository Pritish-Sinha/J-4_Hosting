!function(){"use strict";var e=window.wp.element,t=window.lodash,s=window.wp.i18n,r=window.wp.blocks,n=window.wp.components,c=window.wp.compose,l=window.wp.blockEditor,o=window.wp.hooks,u=({attributes:t,setAttributes:r,clientId:n})=>{(0,e.useEffect)((()=>{if(t.customCSS){if(t.className){const e=t.className;e.includes("ticss-")&&(u.current=e.split(" "),u.current=u.current.find((e=>e.includes("ticss"))))}const e=new RegExp("."+u.current,"g"),s=t.customCSS.replace(e,"selector");o.current=s}else o.current="selector {\n}\n";l.current=wp.CodeMirror(document.getElementById("otter-css-editor"),{value:o.current,autoCloseBrackets:!0,continueComments:!0,lineNumbers:!0,lineWrapping:!0,matchBrackets:!0,lint:!0,gutters:["CodeMirror-lint-markers"],styleActiveLine:!0,styleActiveSelected:!0,extraKeys:{"Ctrl-Space":"autocomplete","Alt-F":"findPersistent","Cmd-F":"findPersistent"}}),l.current.on("change",(()=>{const e=new RegExp("selector","g"),t=l.current.getValue().replace(e,`.${u.current}`);if(o.current=t,"selector {\n}\n".replace(/\s+/g,"")===o.current.replace(/\s+/g,""))return r({customCSS:null});r({customCSS:o.current})}))}),[]),(0,e.useEffect)((()=>{let e=c();r({hasCustomCSS:!0,className:e})}),[t]);const c=()=>{let e;const s=n.substr(0,8);return null!==o.current&&"selector {\n}\n".replace(/\s+/g,"")===o.current.replace(/\s+/g,"")?t.className:(t.className?(e=t.className,e.includes("ticss-")||(e=e.split(" "),e.push(`ticss-${s}`),e=e.join(" ")),u.current=e.split(" "),u.current=u.current.find((e=>e.includes("ticss")))):(e=`ticss-${s}`,u.current=e),e)},l=(0,e.useRef)(null),o=(0,e.useRef)(null),u=(0,e.useRef)(null);return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",null,(0,s.__)("Add your custom CSS.","otter-blocks")),(0,e.createElement)("div",{id:"otter-css-editor",className:"otter-css-editor"}),(0,e.createElement)("p",null,(0,s.__)("Use","otter-blocks")," ",(0,e.createElement)("code",null,"selector")," ",(0,s.__)("to target block wrapper.","otter-blocks")),(0,e.createElement)("br",null),(0,e.createElement)("p",null,(0,s.__)("Example:","otter-blocks")),(0,e.createElement)("pre",{className:"otter-css-editor-help"},"selector {\n    background: #000;\n}\n\nselector img {\n    border-radius: 100%;\n}"),(0,e.createElement)("p",null,(0,s.__)("You can also use other CSS syntax here, such as media queries.","otter-blocks")))},a=window.wp.data;(0,a.subscribe)((()=>{const{getBlocks:e}=(0,a.select)("core/block-editor");(e=>{let t=document.getElementById("otter-css-editor-styles");null===t&&(t=document.createElement("style"),t.setAttribute("type","text/css"),t.setAttribute("id","otter-css-editor-styles"),document.getElementsByTagName("head")[0].appendChild(t)),t.textContent===e||(t.textContent=e)})(((e,s)=>{if(!e)return"";const n=e=>{const t=[];if("core/block"===e.name&&null!==s){const c=s.find((t=>e.attributes.ref===t.id));if(c&&c.content){const e=c.content.hasOwnProperty("raw")?c.content.raw:c.content;t.push((0,r.parse)(e).map((e=>[e,n(e)])))}}return void 0!==e.innerBlocks&&0<e.innerBlocks.length&&t.push(e.innerBlocks.map((e=>[e,n(e)]))),t},c=e.map((e=>[e,n(e)]));return(0,t.flattenDeep)(c).map((e=>e.attributes&&e.attributes.hasCustomCSS&&e.attributes.customCSS&&null!==e.attributes.customCSS?e.attributes.customCSS+"\n":"")).reduce(((e,t)=>e+t),"")})(e(),(0,a.select)("core").getEntityRecords("postType","wp_block")))}));const i=(0,c.createHigherOrderComponent)((t=>c=>(0,r.hasBlockSupport)(c.name,"customClassName",!0)&&c.isSelected?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t,c),(0,e.createElement)(l.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:(0,s.__)("Custom CSS","otter-blocks"),initialOpen:!1},(0,e.createElement)(u,{clientId:c.clientId,setAttributes:c.setAttributes,attributes:c.attributes})))):(0,e.createElement)(t,c)),"withInspectorControl");(0,o.addFilter)("blocks.registerBlockType","themeisle-custom-css/attribute",(e=>((0,r.hasBlockSupport)(e,"customClassName",!0)&&(e.attributes=(0,t.assign)(e.attributes,{hasCustomCSS:{type:"boolean",default:!1},customCSS:{type:"string",default:null}})),e))),(0,o.addFilter)("editor.BlockEdit","themeisle-custom-css/with-inspector-controls",i)}();